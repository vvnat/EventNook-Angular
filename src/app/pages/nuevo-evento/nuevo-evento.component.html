<app-header></app-header>
<main>
    <h2>Creación del evento</h2>
    <section class="over-hide z-bigger" id="sectionForm">
        <form [formGroup]="eventForm" (submit)="onEventForm()">

            <h4>Selecciona el tipo de evento que deseas organizar:</h4>

            <input type="radio" class="checkbox-tools" name="eventType" id="0" value="0" formControlName="eventType">
            <label for="0" class="for-checkbox-tools">{{eventTypes[0].name}}</label>

            <input type="radio" class="checkbox-tools" name="eventType" id="1" value="1" formControlName="eventType">
            <label for="1" class="for-checkbox-tools">{{eventTypes[1].name}}</label>

            <input type="radio" class="checkbox-tools" name="eventType" id="2" value="2" formControlName="eventType">
            <label for="2" class="for-checkbox-tools">{{eventTypes[2].name}}</label>

            <input type="radio" class="checkbox-tools" name="eventType" id="3" value="3" formControlName="eventType">
            <label for="3" class="for-checkbox-tools">{{eventTypes[3].name}}</label>

            <div class="fechas">
                <h4>Fecha de inicio: </h4>
                <h4>Fecha de fin: </h4>
            <input type="datetime-local" required formControlName="startDate">
            <input type="datetime-local" required formControlName="endDate">

            </div>

            <h4>Selecciona el número de invitados: </h4>
            <input type="number" required formControlName="guestsNumber">
            
            <h4></h4>
            <button type="submit">Continuar</button>
        </form>
    </section>

    <section id="section2" style="display: none;">
        <p>Espacios disponibles para el {{form.startDate | date:'dd/MM/yyyy'}} -> {{form.endDate | date:'dd/MM/yyyy'}}</p>
            @for (space of spacesByTypeAndCapacity; track space.id) {
                <article class="space">
                    <h3>{{ space.name }}</h3>
                        <img [src]="space.image" [alt]="space.name">
                        <div>
                        <p>{{ space.description }}</p>
                        <p>Aforo: {{ space.capacity }} personas</p>
                        <p>{{ space.price }} €/día</p>
                        <p>Dirección: {{space.address}}</p>
                        <p>Contacto: {{space.contactNumber}}</p>
                        </div>
                        <button (click)="spaceSelected(space.id)" class="seleccionarButton">Seleccionar</button>
                </article>
            }
    </section>

    <section id="section3" style="display: none;">
        <p>Caterings disponibles para el {{form.startDate | date:'dd/MM/yyyy'}} -> {{form.endDate | date:'dd/MM/yyyy'}}</p>
        <div (click)="cateringNotSelected()">
            <h4>Seguir sin servicio de catering</h4>
            <img src="../../../assets/icons/icono-flecha.png" alt="seguir">
        </div>
        @for (catering of caterings; track catering.id) {
            <article class="catering">
                <h3>{{ catering.name }}</h3>
                    <div>
                    <p>{{ catering.description }}</p>
                    <p>{{ catering.price }} €/persona</p>
                    <p>Contacto: {{catering.contactNumber}}</p>
                    </div>
                    <button (click)="cateringSelected(catering.id)" class="seleccionarButton">Seleccionar</button>
            </article>
        }
    </section>

    <section id="section4" style="display: none;">
        <p>Músicos disponibles para el {{form.startDate | date:'dd/MM/yyyy'}} -> {{form.endDate | date:'dd/MM/yyyy'}}</p>
        <div (click)="musicianNotSelected()">
            <h4>Seguir sin servicio de música</h4>
            <img src="../../../assets/icons/icono-flecha.png" alt="seguir">
        </div>
        @for (musician of musicians; track musician.id) {
            <article class="catering">
                <h3>{{ musician.name }}</h3>
                    <div>
                    <p>{{ musician.description }}</p>
                    <p>{{ musician.price }} €/día</p>
                    <p>Contacto: {{musician.contactNumber}}</p>
                    </div>
                    <button (click)="musicianSelected(musician.id)" class="seleccionarButton">Seleccionar</button>
            </article>
        }
    </section>

    <section id="section5" style="display: none;">
        <h4>Servicios extras</h4>

        <form [formGroup]="eventForm" (submit)="onExtraServices()">
            <input type="checkbox" id="0" value="1" formControlName="open_bar">
            <label for="0" class="for-checkbox-tools">Barra libre de bebidas (+5€/persona)</label>
    
            <input type="checkbox" id="1" value="1" formControlName="photographer">
            <label for="1" class="for-checkbox-tools">Fotógrafo (+800€)</label>
        </form>

        <button (click)="onExtraServices()">Finalizar</button>
    </section>

    <section id="resumen" style="display: none;">
        <h2>Resumen del evento:</h2>
        <p>Tipo de evento: {{eventTypes[form.eventType].name}}</p>
        <p>Fecha de inicio: {{form.startDate | date:'dd/MM/yyyy'}}</p>
        <p>Fecha de fin: {{form.endDate | date:'dd/MM/yyyy'}}</p>
        <p>Número de invitados: {{form.guestsNumber}}</p>
        <p>Espacio seleccionado: {{selectedSpace}}</p>
        <p>Catering seleccionado: {{selectedCatering}}</p>
        <p>Músico seleccionado: {{selectedMusician}}</p>
        <span>Barra libre de bebidas: </span>
        @if (form.open_bar) {
            <span>Sí</span>
        }@else {
            <span>No</span>
        }
        <p> </p>
        <span>Fotógrafo: </span>
        @if (form.photographer) {
            <span>Sí</span>
        }@else {
            <span>No</span>
        }
        <p>Precio final: {{precioTotal}}€</p>

        <button (click)="onSave()" routerLink="/home">Confirmar</button>
    </section>
</main>